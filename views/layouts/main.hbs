<!DOCTYPE html>
<html lang="en">

    <head>

        <!-- Title -->
        <title>{{> title}}</title>

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <meta charset="UTF-8">
        <meta name="description" content="Responsive Admin Dashboard Template" />
        <meta name="keywords" content="admin,dashboard" />
        <meta name="author" content="Steelcoders" />

        <!-- Styles -->
        <link type="text/css" rel="stylesheet" href="../../plugins/materialize/css/materialize.min.css" />
        <link href="http://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
        <link href="../../plugins/metrojs/MetroJs.min.css" rel="stylesheet">
        <link href="../../plugins/weather-icons-master/css/weather-icons.min.css" rel="stylesheet">
        <link href="../../plugins/sweetalert/sweetalert.css" rel="stylesheet" type="text/css" />



        <link href="../../plugins/datatables/css/jquery.dataTables.min.css" rel="stylesheet">
        <link href="../../css/buttons.dataTables.min.css" rel="stylesheet">
        <link rel="stylesheet" type="text/css"
            href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />
        <!--    <link rel="stylesheet" type="text/css" href="https://www.daterangepicker.com/daterangepicker.css" /> -->




        <!-- Theme Styles -->
        <link href="../../css/alpha.min.css" rel="stylesheet" type="text/css" />
        <link href="../../css/custom.css" rel="stylesheet" type="text/css" />
        <link href="../../main.css" rel="stylesheet" type="text/css" />

        <link href="../../plugins/select2/css/select2.css" rel="stylesheet">
        <link href="../../css/custom-menu.css" rel="stylesheet">

        <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.19.2/axios.min.js"></script>



        <style>
      /*  styling scrollbars  */
      ::-webkit-scrollbar {
        width: 0.8em;
        height: 0.8em;
        margin: 5em 5em;
      }

      ::-webkit-scrollbar-track {
        background: transparent;

        margin: 10em 20em;
      }

      ::-webkit-scrollbar-thumb {
        background: #d9dadb;
        border-radius: 10px;
        border: 0.2em solid white;
        padding: 0 2px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: #8c8d8f;
        border-radius: 10px;
        border: 0.2em solid white;
        padding: 0 2px;
      }
    </style>

        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
        <script src="http://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="http://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->

    </head>

    <script>

        var datatable;

    </script>

    <body>

        {{> loader}}

        <div class="mn-content fixed-sidebar">

            {{> header}}
            {{> sidebar}}

            <main class="mn-inner">
                <div class="row">
                    {{{body}}}
                </div>
            </main>



        </div>

        <script src="../../plugins/jquery/jquery-2.2.0.min.js"></script>
        <script src="../../plugins/materialize/js/materialize.min.js"></script>
        <script src="../../plugins/material-preloader/js/materialPreloader.min.js"></script>
        <script src="../../plugins/jquery-blockui/jquery.blockui.js"></script>
        <script src="../../plugins/sweetalert/sweetalert.min.js"></script>



        <!--  <script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script> -->
        <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
        <script type="text/javascript"
            src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>

        <script src="../../js/swift/users.js"></script>
        <script src="../../js/swift/login.js"></script>
        <script src="../../js/swift/logout.js"></script>
        <script src="../../js/swift/company.js"></script>
        <script src="../../js/swift/auth.js"></script>
        <script src="../../js/swift/notification.js"></script>
        <script src="../../js/swift/paths.js"></script>
        <script src="../../js/swift/alerts.js"></script>
        <script src="../../js/swift/sms.js"></script>
        <script src="../../js/swift/msg.js"></script>
        <script src="../../js/swift/msgmodal.js"></script>

        <script src="../../js/swift/role.js"></script>
        <script src="../../js/swift/menu.js"></script>
        <script src="../../js/swift/rolemenu.js"></script>
        <script src="../../js/swift/usermenu.js"></script>
        <script src="../../js/swift/rolemenus.js"></script>
        <script src="../../js/swift/usermenus.js"></script>

        <script src="../../js/pages/custom-form.js"></script>

        <script src="../../plugins/datatables/js/jquery.dataTables.min.js"></script>
        <script src="../../plugins/datatables/js/dataTables.buttons.min.js"></script>
        <script src="../../plugins/datatables/js/dataTables.fixedColumns.min.js"></script>


        <script src="../../plugins/datatables/js/jszip.min.js"></script>
        <script src="../../plugins/datatables/js/pdfmake.min.js"></script>
        <script src="../../plugins/datatables/js/vfs_fonts.js"></script>
        <script src="../../plugins/datatables/js/buttons.html5.min.js"></script>
        <script src="../../plugins/datatables/js/buttons.print.min.js"></script>
        <script src="../../plugins/select2/js/select2.min.js"></script>
        <script src="../../js/pages/form-select2.js"></script>


        <script src="../../js/pages/table-data1.js"></script>

        <!--<script type="text/javascript" src="https://longbill.github.io/jquery-date-range-picker/src/jquery.daterangepicker.js"></script>-->



        <!--<script type="text/javascript" src=" https://www.daterangepicker.com/daterangepicker.js"></script>-->

        <script src="../../js/alpha.min.js"></script>

        {{#if usedef}}
            <!-- Javascripts -->
            <script src="../../plugins/sweetalert/sweetalert.min.js"></script>
            <script src="../../js/pages/miscellaneous-sweetalert.js"></script>


            <script src="../../plugins/waypoints/jquery.waypoints.min.js"></script>
            <script src="../../plugins/counter-up-master/jquery.counterup.min.js"></script>
            <script src="../../plugins/jquery-sparkline/jquery.sparkline.min.js"></script>
            <script src="../../plugins/chart.js/chart.min.js"></script>
            <script src="../../plugins/flot/jquery.flot.min.js"></script>
            <script src="../../plugins/flot/jquery.flot.time.min.js"></script>
            <script src="../../plugins/flot/jquery.flot.symbol.min.js"></script>
            <script src="../../plugins/flot/jquery.flot.resize.min.js"></script>
            <script src="../../plugins/flot/jquery.flot.tooltip.min.js"></script>
            <script src="../../plugins/curvedlines/curvedLines.js"></script>
            <script src="../../plugins/peity/jquery.peity.min.js"></script>
            <script src="../../js/alpha.min.js"></script>
            <script src="../../js/pages/dashboard.js"></script>
        {{/if}}

        {{#if (checkView viewname 'viewmessages')}}

            <script src="../../plugins/datatables/js/jquery.dataTables.min.js"></script>
            <script src="../../plugins/datatables/js/dataTables.buttons.min.js"></script>
            <script src="../../plugins/datatables/js/dataTables.fixedColumns.min.js"></script>


            <script src="../../plugins/datatables/js/jszip.min.js"></script>
            <script src="../../plugins/datatables/js/pdfmake.min.js"></script>
            <script src="../../plugins/datatables/js/vfs_fonts.js"></script>
            <script src="../../plugins/datatables/js/buttons.html5.min.js"></script>
            <script src="../../plugins/datatables/js/buttons.print.min.js"></script>


            <script src="../../js/pages/table-data.js"></script>



        {{/if}}

        <script src="../../js/pages/custom-menu.js" defer></script>
    </body>

</html>

{{#if (checkView viewname 'viewmessages')}}

    <script type="text/javascript">

        function showMailDialog(txtdata, myform) {
            $('#report_txtdoc').val(txtdata);
            $('#report_form').val(myform);
            //$('#asendmailmodal').click();
            //$('#asendmailmodal').trigger("click");
        }

        function sendMail(txtdoc) {
            //alert('going to send')
            //alert($('#report_email').val())
            //alert($('#report_txtdoc').val())
            //alert($('#report_textarea').val())   
            //alert($('#report_form').val())
            let email = $('#report_email').val()
            let text = $('#report_textarea').val()

           /* $.post("sendmail",
                {
                    emails: $('#report_email').val(),
                    message: $('#report_textarea').val(),
                    txtdoc: $('#report_txtdoc').val()

                }, function (data, status) {
            */

                let url = "/swift/getpdflinkandemail";
                $.ajax({
                    url: url,

                    method: "POST",

                    dataType: "json",


                    cache: false,

                    contentType: "application/json",

                    data: JSON.stringify({
                        email: email,
                        text: text,
                    }),
                    

                    success: function (res) {
                        $("#loader").hide();


                        swal(
                            {
                                title: "Email Success!",
                                text: `Swift message has been successfully sent to customers email`,
                                type: "success",
                            },
                            
                        );
                    },
                    error: function (xhr, status, error) {
                        $("#loader").hide();

                        if (xhr.readyState == 4) {

                            var err = JSON.parse(xhr.responseText);

                            $("form").trigger("reset");

                            swal({
                                icon: "error",

                                title: "Ooops...",

                                text: err.message,

                                footer: "<a href>Why do I have this issue?</a>",
                            });
                        } else if (xhr.readyState == 0) {

                            $("form").trigger("reset");

                            swal({
                                icon: "error",

                                title: "Ooops...",

                                text: "Network error (i.e. connection refused, access denied due to CORS, etc.)",

                                footer: "<a href>Why do I have this issue?</a>",
                            });
                        } else {

                            $("form").trigger("reset");

                            swal({
                                icon: "error",

                                title: "Ooops...",

                                text: "something weird is happening",

                                footer: "<a href>Why do I have this issue?</a>",
                            });
                        }
                    },
                });

                    /*if (data == "1") {
                        swal("E-Mail", "Message Sent To: " + $('#report_email').val(), "success");
                    }
                    else {
                        swal("E-Mail", "Message Not Sent", "error");
                    }*/
                /*});*/

        }
        let jsdataa
        function showmsg(txtdata, obj) {
            jsdataa = obj
            let rawDaata 

            let pdfDt
            let imgDt

            //$.get("/swift/getmessage?id=1&code=x&txtdata=" + txtdata, function (data) {
                //$("#swiftnotice").text($.trim(data));
           // });

            //$('#getpdf').attr('name', txtdata);
            //$('#getimage').attr('name', txtdata);
            //$('#sendpdf').attr('name', txtdata);

            let url = "/swift/getrawmsg";
                $.ajax({
                    url: url,

                    method: "POST",

                    dataType: "json",

                    
                    cache: false,

                    contentType: "application/json",
                    data: JSON.stringify({
                        docname: obj.docname
                    }),
                    

                    success: function (res) {
                        imgDt = res.pdfdlink
                        $("#loader").hide();
                        
                        $("#swiftnotice").text($.trim(res.rawdata));

                    },
                    error: function (xhr, status, error) {
                        $("#loader").hide();

                        if (xhr.readyState == 4) {

                            var err = JSON.parse(xhr.responseText);

                            $("form").trigger("reset");

                            swal({
                                icon: "error",

                                title: "Ooops...",

                                text: err.message,

                                footer: "<a href>Why do I have this issue?</a>",
                            });
                        } else if (xhr.readyState == 0) {

                            $("form").trigger("reset");

                            swal({
                                icon: "error",

                                title: "Ooops...",

                                text: "Network error (i.e. connection refused, access denied due to CORS, etc.)",

                                footer: "<a href>Why do I have this issue?</a>",
                            });
                        } else {

                            $("form").trigger("reset");

                            swal({
                                icon: "error",

                                title: "Ooops...",

                                text: "something weird is happening",

                                footer: "<a href>Why do I have this issue?</a>",
                            });
                        }
                    },
                });

            $('#msenderRef').text("REF: " + obj.F20_1);
            //$('#getpdf').click(function () { getpdf(txtdata, 0); });
            //$('#getimage').click(function () { getimage(imgDt, 0); });
           // $('#sendpdf').click(function () { showMailDialog(txtdata, 0); });

            $('#SenderX').text(obj.Sender);
            $('#RecieverX').text(obj.Reciever);
            $('#ReferenceX').text(obj.F20_1);
            $('#DateX').text(obj.cdate);
            $('#TimeX').text(obj.ctime);
            $('#MtypeX').text(obj.mtype);
            $('#inoutX').text(obj.dir);
             

            /*
            <li class="collection-item" >Sender: <label class="green-text" id="SenderX"></label></li>
            <li class="collection-item" >Reciever: <label class="green-text" id="RecieverX"></label></li>
            <li class="collection-item" >Reference: <label class="green-text" id="ReferenceX"></label></li>
            <li class="collection-item" >Date: <label class="green-text" id="DateX"></label></li>
            <li class="collection-item" >Time: <label class="green-text" id="TimeX"></label></li>
            <li class="collection-item" >Message Type: <label class="green-text" id="MtypeX"></label></li>
            <li class="collection-item" >In/Out: <label class="green-text" id="inoutX"></label></li>
            */

            $('#showmsgdetails').click();
           // $('#showmsgdetails').trigger("click");

        }

        //function showmessage(myform,txtdata,formkey,sendref)age
       // function showmessage(myform, txtdata, formkey, sendref) {
         //   var rows = datatable.rows(formkey).data();


           // $.get("getmessage?id=1&code=x&txtdata=" + txtdata, function (data) {
                //$("#swiftnotice").text($.trim(data));

            //});

            //$('#getimage').attr('name', txtdata);
            //$('#getpdf').attr('name', txtdata);
            //$('#sendpdf').attr('name', txtdata);

            //alert(sendref)

            //$('#msenderRef').text("REF: " + sendref);


            //$('#getimage').click(function () { getimage(this.name, 0); });
            //$('#getpdf').click(function () { getpdf(this.name, 0); });
            //$('#sendpdf').click(function () { showMailDialog(this.name, 0); });



            /*
            
                            <li class="collection-item" >Sender: <label class="green-text">{{this.BenName}}</label></li>
                            <li class="collection-item" >Reciever: <label class="green-text">{{this.OderingCustomerName}}</label></li>
                            <li class="collection-item" >Reference: <label class="green-text">{{this.Amount}}</label></li>
                            <li class="collection-item" >Date: <label class="green-text">{{this.Currency}}</label></li>
                            <li class="collection-item" >Time: <label class="green-text">{{this.Valdate}}</label></li>
                            <li class="collection-item" >Message Type: <label class="green-text">{{this.mtype}}</label></li>
                            <li class="collection-item" >In/Out: <label class="green-text">{{this.NetStatus}}</label></li>
            
            */
            //$('#' + myform + '').click();
            //$('#' + myform + '').trigger("click");
        //}

        /*function getimage1(myform, frmkey) {
            $.get("getimage1?doc=" + myform, function (data) {

                alert("getimage1")

                let url = "/swift/getimagelink";
                $.ajax({
                    url: url,

                    method: "POST",

                    dataType: "json",

                    
                    cache: false,

                    contentType: "application/json",
                    data: JSON.stringify({
                        docname: data.docname
                    }),
                    

                    success: function (res) {
                        $("#loader").hide();

                        swal(
                            {
                                title: "Download Success!",
                                text: `Get downloaded file from ${res}.`,
                                type: "success",
                            },
                            
                        );
                    },
                    error: function (xhr, status, error) {
                        $("#loader").hide();

                        if (xhr.readyState == 4) {

                            var err = JSON.parse(xhr.responseText);

                            $("form").trigger("reset");

                            swal({
                                icon: "error",

                                title: "Ooops...",

                                text: err.message,

                                footer: "<a href>Why do I have this issue?</a>",
                            });
                        } else if (xhr.readyState == 0) {

                            $("form").trigger("reset");

                            swal({
                                icon: "error",

                                title: "Ooops...",

                                text: "Network error (i.e. connection refused, access denied due to CORS, etc.)",

                                footer: "<a href>Why do I have this issue?</a>",
                            });
                        } else {

                            $("form").trigger("reset");

                            swal({
                                icon: "error",

                                title: "Ooops...",

                                text: "something weird is happening",

                                footer: "<a href>Why do I have this issue?</a>",
                            });
                        }
                    },
                });

                /*var link = document.createElement('a');
                link.href = '/getimage?img=' + data.img;
                link.click();


                $('#frmclose' + frmkey).click();
                $('#frmclose' + frmkey).trigger("click");

                swal("Download", "Message Downloaded", "success");

            });
        }*/

        function getpdf(txtdata, obj) {
            
           
            let url = "/swift/getpdflink";
                $.ajax({
                    url: url,

                    method: "POST",

                    dataType: "json",

                    
                    cache: false,

                    contentType: "application/json",
                    data: JSON.stringify({
                        docname: jsdataa.docname
                    }),
                    

                    success: function (res) {
                        $("#loader").hide();

                      
        

                         const link = document.createElement('a');

                        //console.log('beginning obstacle' + `data:,${jsdataa.docname}.pdf`);

                        link.setAttribute("href", `data:,${res}`);

                        //console.log('first obstacle');

                        link.setAttribute('download', `${jsdataa.docname}.pdf`);

                        //console.log('second obstacle');

                        document.body.appendChild(link);

                        //console.log('third obstacle');

                        link.click();
                        document.body.removeChild(link)

                        //console.log('fourth obstacle');

                        swal(
                            {
                                title: "Download Success!",
                                text: `Downloaded file Successfully.`,
                                type: "success",
                            },
                            
                        );

                        return


                    },
                    error: function (xhr, status, error) {
                        $("#loader").hide();

                        if (xhr.readyState == 4) {

                            var err = JSON.parse(xhr.responseText);

                            $("form").trigger("reset");

                            swal({
                                icon: "error",

                                title: "Ooops...",

                                text: err.message,

                                footer: "<a href>Why do I have this issue?</a>",
                            });
                        } else if (xhr.readyState == 0) {

                            $("form").trigger("reset");

                            swal({
                                icon: "error",

                                title: "Ooops...",

                                text: "Network error (i.e. connection refused, access denied due to CORS, etc.)",

                                footer: "<a href>Why do I have this issue?</a>",
                            });
                        } else {

                            $("form").trigger("reset");

                            swal({
                                icon: "error",

                                title: "Ooops...",

                                text: "something weird is happening",

                                footer: "<a href>Why do I have this issue?</a>",
                            });
                        }
                    },
                });

                //return
            //$.get("/pdf" + txtdata, function (data) {
                
                //const splir = data.pdf.split(".")


                //const joint = `${splir[0]}.${splir[1]}`

                //alert("getpdf")

               


                /*var link=document.createElement('a');
                link.href='/getpdf?pdf='+data.pdf;
                link.click();
        
                
                $('#frmclose'+frmkey).click();
                $('#frmclose'+frmkey).trigger("click");
        
                swal("Download", "Message Downloaded", "success"); */

            //});
        }

        function getimage(myform, frmkey) {
           /* $.get("getpdf?doc=" + myform, function (data) {
                alert("getimage")*/

               let url = "/swift/getimagelink";
                $.ajax({
                    url: url,

                    method: "POST",

                    dataType: "json",

                    
                    cache: false,

                    contentType: "application/json",
                    data: JSON.stringify({
                        docname: jsdataa.docname
                    }),
                    

                    success: function (res) {
                        
                        $("#loader").hide();

                        swal(
                            {
                                title: "Download Success!",
                                text: `Get downloaded file from ${res}.`,
                                type: "success",
                            },
                            
                        );

                        //return
                    },
                    error: function (xhr, status, error) {
                        $("#loader").hide();

                        if (xhr.readyState == 4) {

                            var err = JSON.parse(xhr.responseText);

                            $("form").trigger("reset");

                            swal({
                                icon: "error",

                                title: "Ooops...",

                                text: err.message,

                                footer: "<a href>Why do I have this issue?</a>",
                            });
                        } else if (xhr.readyState == 0) {

                            $("form").trigger("reset");

                            swal({
                                icon: "error",

                                title: "Ooops...",

                                text: "Network error (i.e. connection refused, access denied due to CORS, etc.)",

                                footer: "<a href>Why do I have this issue?</a>",
                            });
                        } else {

                            $("form").trigger("reset");

                            swal({
                                icon: "error",

                                title: "Ooops...",

                                text: "something weird is happening",

                                footer: "<a href>Why do I have this issue?</a>",
                            });
                        }
                    },
                });

                //return
               /* const date = Date.now();

                alert(myform)
                console.log(myform)
                var link=document.createElement('a');
                link.href='/getpdf?pdf='+data.pdf;
                link.download=`${jsdataa.docname}-${date}.pdf`
                link.click();
        
                
                $('#frmclose'+frmkey).click();
                $('#frmclose'+frmkey).trigger("click");
        
                swal("Download", "Message Downloaded", "success"); */

            //});
        }

    </script>

{{/if}}